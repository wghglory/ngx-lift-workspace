<cll-page-container [title]="'dgState'" customClass="space-y-9">
  <!-- Overview -->
  <section class="space-y-4">
    <h2>Overview</h2>
    <p>
      The <code>dgState</code> operator is an RxJS operator designed to manage Clarity Datagrid state transformations
      with intelligent debouncing and duplicate filtering. It assesses changes in datagrid filters and handles API
      trigger events efficiently.
    </p>

    <p>
      When filters are modified, the operator introduces a 500ms debounce before initiating the API call, preventing
      excessive requests during rapid typing. For actions such as sorting or pagination, the API call is made promptly
      without delay.
    </p>

    <p>
      The operator also provides an optional parameter to control the use of <code>distinctUntilChanged</code>. When
      enabled (default: <code>true</code>), it ensures that no API call is initiated if the datagrid state remains the
      same, preventing redundant requests.
    </p>
  </section>

  <!-- API Reference -->
  <section class="space-y-4">
    <h2>API Reference</h2>
    <div class="space-y-3">
      <h3>dgState</h3>
      <p>
        RxJS operator for handling Clarity Datagrid state transformations with debouncing and optional
        distinctUntilChanged behavior.
      </p>

      <h4>Signature</h4>
      <div class="space-y-2">
        <p>
          <code
            >dgState(enableDistinctUntilChanged?: boolean): UnaryFunction&lt;Observable&lt;ClrDatagridStateInterface |
            null&gt;, Observable&lt;ClrDatagridStateInterface | null&gt;&gt;</code
          >
        </p>
        <p><strong>Parameters:</strong></p>
        <ul class="list-disc space-y-1 ml-6">
          <li>
            <code>enableDistinctUntilChanged</code>: <em>(Optional)</em> Whether to enable distinctUntilChanged
            filtering. Defaults to <code>true</code>. When <code>true</code>, suppresses duplicate states. When
            <code>false</code>, allows API calls even for identical states.
          </li>
        </ul>
        <p>
          <strong>Returns:</strong> A RxJS pipe function that transforms an observable of
          <code>ClrDatagridStateInterface | null</code>
        </p>
      </div>

      <h4>Behavior</h4>
      <ul class="list-disc space-y-1 ml-6">
        <li>Adds a 500ms debounce when filters change (to avoid excessive API calls)</li>
        <li>Optionally filters out duplicate consecutive states</li>
        <li>Starts with a null state to handle initial load scenarios</li>
      </ul>
    </div>
  </section>

  <!-- Basic Usage -->
  <section class="space-y-4">
    <h2>Basic Usage</h2>
    <p>Use <code>dgState</code> in your observable pipeline to manage datagrid state changes efficiently:</p>
    <app-code-block [code]="typescriptCode" />
  </section>

  <!-- Examples -->
  <section class="space-y-4">
    <h2>Examples</h2>

    <article class="space-y-3">
      <h3>API Response Structure</h3>
      <p>Assume we have an API returning the following shape of data for a server-driven datagrid:</p>
      <app-code-block [code]="dataCode" lang="json" />
    </article>

    <article class="space-y-3">
      <h3>Template Implementation</h3>
      <p>Use the async pipe directly in your template:</p>
      <app-code-block [code]="secondHtmlCode" lang="html" />
      <p>Alternatively, use async pipe with <code>&#64;if</code> for better type safety:</p>
      <app-code-block [code]="htmlCode" lang="html" />
    </article>

    <cll-callout>
      <p>
        You can use the <a class="underline" [routerLink]="['/clr-lift/utilities/datagrid']">convertToHttpParams</a>
        utility function to convert the datagrid state into HTTP parameters. See the documentation for more details.
      </p>
    </cll-callout>
  </section>

  <!-- Live Example -->
  <section class="space-y-4">
    <h2>Live Example</h2>
    <p>Below is a working example of a server-driven datagrid using the <code>dgState</code> operator:</p>
    <app-user-datagrid />
  </section>
</cll-page-container>
