<cll-page-container [title]="'Timeline Wizard'" customClass="space-y-9">
  <!-- Overview -->
  <p>
    The TimelineWizard component is designed to facilitate the creation of a timeline-based wizard in Angular
    applications. This component allows you to create a series of steps, each represented by a component, and navigate
    through them using a timeline. The TimelineWizard component provides features such as step navigation, asynchronous
    validation, and dynamic component rendering. Each step component must extend <code>TimelineBaseComponent</code> and
    can optionally include forms, custom data mapping, and asynchronous operations.
  </p>

  <!-- Examples Section -->
  <section class="space-y-4">
    <h2>Examples</h2>

    <article class="space-y-3">
      <h3>Example 1: Basic Wizard Setup</h3>
      <p>
        In the following example, the wizard comprises four distinct steps. The timelineSteps array defines the
        sequential order of each step. Three of these steps, namely "Configure Operator," "Configure Service," and
        "Configure Runtime Properties," involve form input. The last step, labeled "Review," acts as a comprehensive
        summary, consolidating data from the preceding steps for presentation.
      </p>
      <app-code-block [code]="wizardCode" lang="typescript" />
      <app-code-block [code]="deploymentTypeCode" lang="typescript" />
    </article>

    <article class="space-y-3">
      <h3>Example 2: Basic Step Component</h3>
      <p>
        Every step component is required to extend the base class, <code>TimelineBaseComponent</code>, specifying the
        pertinent step type. The significance of this specification lies in the fact that the
        <code>currentStepData</code> type aligns with the type defined in <code>TimelineBaseComponent</code>. For
        form-based steps, it is essential to override the form property and instantiate the FormGroup. There exist two
        methods to retrieve the current step data and all steps data. Firstly, you can employ the
        <code>TimelineWizardService</code> by invoking the <code>getStepData</code> method with the step id or title as
        the identifier. Alternatively, within the ngOnInit lifecycle hook, you can access
        <code>currentStepData</code> and <code>allStepsData</code> —these two properties are input properties in
        <code>TimelineBaseComponent</code>. It is imperative to note that attempting to access these properties in the
        constructor is prohibited due to their unavailability at that particular stage of the component lifecycle.
      </p>
      <app-code-block [code]="operatorCode" lang="typescript" />
    </article>

    <article class="space-y-3">
      <h3>Example 3: Custom Data Mapping</h3>
      <p>
        In situations where your <code>FormGroup</code> model does not precisely align with the data structure outlined
        in the <code>timelineSteps</code>, customization of the mapping logic becomes necessary. This involves the
        overriding of two key methods: <code>formValueToData</code> and <code>dataToFormValue</code>. Consider a
        scenario where the <code>FormGroup</code> consists of three controls—<code>cpu</code>, <code>replicas</code>,
        and <code>url</code>. Contrastingly, the <code>timelineSteps</code> data structure follows the pattern
        <code>service: cpu, replicas, url</code>. This discrepancy necessitates adjustments to ensure compatibility.
      </p>
      <app-code-block [code]="serviceCode" lang="typescript" />
    </article>

    <article class="space-y-3">
      <h3>Example 4: Advanced Data Mapping with Key-Value Inputs</h3>
      <p>
        Illustrating a more advanced use case, consider the following example that delves into the intricacies of
        <code>dataToFormValue</code> and <code>formValueToData</code> customization using the KeyValueInputsComponent:
      </p>
      <app-code-block [code]="runtimePropsCode" lang="typescript" />
      <cll-callout>
        To understand more about KeyValueInputsComponent, please visit
        <a [routerLink]="['/clr-lift/components/key-value-inputs']">Key Value Inputs</a>.
      </cll-callout>
    </article>

    <article class="space-y-3">
      <h3>Example 5: Review Step with API Submission</h3>
      <p>
        In certain scenarios, your application might require a review step to consolidate and confirm the submission of
        all preceding form values. Unlike previous step components, there's no need to override the form in the review
        step, as it doesn't involve any form controls. The key focus is on aggregating data from the preceding steps.
        Utilize the <code>TimelineWizardService</code> method <code>getStepData</code> to fetch the necessary data and
        present it in the UI accordingly. Once you've verified that all the data is accurate, you can proceed to submit
        it. To accomplish this, you'll need to perform two main tasks. First, you must aggregate all the steps' data and
        map it to the desired API payload. The second task involves triggering the API call. You can leverage the
        <code>timelineWizardService.allStepsData</code> to obtain all data. However, note that the shape is an array
        containing each step's id or title as an identifier along with the respective step data. To address this, you
        can create a custom data conversion function, such as the <code>buildPayload</code> method outlined below.
        Subsequently, to initiate the API request, override the <code>next$</code> observable to construct your API
        stream.
      </p>
      <app-code-block [code]="reviewCode" lang="typescript" />
      <cll-callout>
        You can customize the <code>next$</code> observable in any step, enabling the inclusion of both asynchronous and
        synchronous operations, such as an API call.
      </cll-callout>
    </article>

    <article class="space-y-3">
      <h3>Example 6: Interactive Demo</h3>
      <p>Try the interactive wizard below:</p>
      <cll-timeline-wizard
        [timelineSteps]="timelineSteps"
        [confirmButtonText]="'Finish'"
        (canceled)="onCanceled()"
        (confirmed)="onConfirmed($event)"
        (finished)="onFinished()"
      />
    </article>
  </section>

  <!-- API Reference -->
  <section class="space-y-4">
    <h2>API Reference</h2>
    <div class="space-y-4">
      <div class="space-y-3">
        <h3>TimelineWizardComponent</h3>
        <p>The main component responsible for managing the timeline wizard.</p>

        <h4>Inputs</h4>
        <ul class="list-disc space-y-2 ml-6">
          <li class="space-y-1">
            <code>timelineSteps: TimelineStep[]</code>
            <div class="ml-4">
              <p class="text-sm !mt-1">
                <em>(Required)</em> An array of <code>TimelineStep</code> objects representing the steps in the wizard.
              </p>
            </div>
          </li>
          <li class="space-y-1">
            <code>live?: boolean</code>
            <div class="ml-4">
              <p class="text-sm !mt-1">
                Controls whether to destroy step components when clicking prev/next buttons. Defaults to
                <code>false</code>.
              </p>
            </div>
          </li>
          <li class="space-y-1">
            <code>confirmButtonText?: string</code>
            <div class="ml-4">
              <p class="text-sm !mt-1">The text for the "Confirm" button. Defaults to "Confirm".</p>
            </div>
          </li>
        </ul>

        <h4>Outputs</h4>
        <ul class="list-disc space-y-2 ml-6">
          <li class="space-y-1">
            <code>confirmed: EventEmitter&lt;unknown&gt;</code>
            <div class="ml-4">
              <p class="text-sm !mt-1">
                Emits all previous steps' data when clicking the finish button in the last step.
              </p>
            </div>
          </li>
          <li class="space-y-1">
            <code>canceled: EventEmitter&lt;void&gt;</code>
            <div class="ml-4">
              <p class="text-sm !mt-1">Emits when the wizard is canceled.</p>
            </div>
          </li>
          <li class="space-y-1">
            <code>finished: EventEmitter&lt;void&gt;</code>
            <div class="ml-4">
              <p class="text-sm !mt-1">Emits when the wizard is successfully completed.</p>
            </div>
          </li>
        </ul>

        <h4>Methods</h4>
        <ul class="list-disc space-y-2 ml-6">
          <li class="space-y-1">
            <code>cancel(): void</code>
            <div class="ml-4">
              <p class="text-sm !mt-1">Cancels the wizard and emits the <code>canceled</code> event.</p>
            </div>
          </li>
          <li class="space-y-1">
            <code>nextStep(): void</code>
            <div class="ml-4">
              <p class="text-sm !mt-1">Moves to the next step in the wizard.</p>
            </div>
          </li>
          <li class="space-y-1">
            <code>previousStep(): void</code>
            <div class="ml-4">
              <p class="text-sm !mt-1">Moves to the previous step in the wizard.</p>
            </div>
          </li>
        </ul>
      </div>

      <div class="space-y-3">
        <h3>TimelineBaseComponent</h3>
        <p>
          The base class for all step components within the timeline wizard. It provides essential properties and
          methods for managing the wizard steps.
          <strong
            >Extend this abstract class for each step component and override specific properties and functions
            accordingly.</strong
          >
        </p>

        <h4>Properties</h4>
        <ul class="list-disc space-y-2 ml-6">
          <li class="space-y-1">
            <code>allStepsData: unknown[]</code>
            <div class="ml-4">
              <p class="text-sm !mt-1">
                An array containing the data of all wizard steps. Available as an input property, accessible in
                <code>ngOnInit</code> and later lifecycle hooks.
              </p>
            </div>
          </li>
          <li class="space-y-1">
            <code>currentStepData: T | null</code>
            <div class="ml-4">
              <p class="text-sm !mt-1">
                The data of the current step or <code>null</code> if not available. Available as an input property,
                accessible in <code>ngOnInit</code> and later lifecycle hooks.
              </p>
            </div>
          </li>
          <li class="space-y-1">
            <code>form: FormGroup | null</code>
            <div class="ml-4">
              <p class="text-sm !mt-1">
                The form group associated with the step. Set to <code>null</code> for steps without a form. Override
                this property in your step component.
              </p>
            </div>
          </li>
          <li class="space-y-1">
            <code>next$: Observable&lt;unknown&gt;</code>
            <div class="ml-4">
              <p class="text-sm !mt-1">
                An observable that emits when the "Next" button is clicked. Override it to perform custom actions, such
                as API calls.
              </p>
            </div>
          </li>
          <li class="space-y-1">
            <code>stepInvalid: boolean</code>
            <div class="ml-4">
              <p class="text-sm !mt-1">Indicates whether the step's form is invalid.</p>
            </div>
          </li>
        </ul>

        <h4>Methods</h4>
        <ul class="list-disc space-y-2 ml-6">
          <li class="space-y-1">
            <code>formValueToData(): unknown</code>
            <div class="ml-4">
              <p class="text-sm !mt-1">
                Converts the step's form value to data. Override this method if your form structure doesn't match the
                step data structure.
              </p>
            </div>
          </li>
          <li class="space-y-1">
            <code>dataToFormValue(data: any): any</code>
            <div class="ml-4">
              <p class="text-sm !mt-1">
                Converts step data to the form value that can be used for <code>patchValue</code>. Override this method
                if your form structure doesn't match the step data structure.
              </p>
            </div>
          </li>
        </ul>
      </div>

      <div class="space-y-3">
        <h3>TimelineStep Interface</h3>
        <p>
          The interface defines the properties of a step in the timeline. You can pass an array of steps to the
          TimelineWizard component as inputs. The shape of this input should match this interface.
        </p>

        <h4>Properties</h4>
        <ul class="list-disc space-y-2 ml-6">
          <li class="space-y-1">
            <code>state: ClrTimelineStepState</code>
            <div class="ml-4">
              <p class="text-sm !mt-1">
                The state of the timeline step (e.g., 'not-started', 'current', 'success', 'error').
              </p>
            </div>
          </li>
          <li class="space-y-1">
            <code>header?: string</code>
            <div class="ml-4">
              <p class="text-sm !mt-1">The header of the timeline step.</p>
            </div>
          </li>
          <li class="space-y-1">
            <code>title: string</code>
            <div class="ml-4">
              <p class="text-sm !mt-1">
                <em>(Required)</em> The title of the timeline step, acting as an identifier (should be unique). Can be
                used to find step data via <code>getStepData</code>.
              </p>
            </div>
          </li>
          <li class="space-y-1">
            <code>id?: string</code>
            <div class="ml-4">
              <p class="text-sm !mt-1">
                The id of the timeline step, acting as a primary identifier. If id is not provided, will use title as
                identifier instead. Can be used to find step data via <code>getStepData</code>.
              </p>
            </div>
          </li>
          <li class="space-y-1">
            <code>description?: string</code>
            <div class="ml-4">
              <p class="text-sm !mt-1">The description of the timeline step.</p>
            </div>
          </li>
          <li class="space-y-1">
            <code>component: Type&lt;any&gt;</code>
            <div class="ml-4">
              <p class="text-sm !mt-1">
                <em>(Required)</em> The Angular component associated with the timeline step. Must extend
                <code>TimelineBaseComponent</code>.
              </p>
            </div>
          </li>
          <li class="space-y-1">
            <code>data?: unknown</code>
            <div class="ml-4">
              <p class="text-sm !mt-1">
                Step data, which will be converted to form data by the timeline wizard component and passed to the step
                component as <code>currentStepData</code>.
              </p>
            </div>
          </li>
        </ul>
      </div>

      <div class="space-y-3">
        <h3>TimelineWizardService</h3>
        <p>
          A service that manages the state and data of the timeline wizard. It provides methods to retrieve steps' data
          and the current step.
        </p>

        <h4>Properties</h4>
        <ul class="list-disc space-y-2 ml-6">
          <li class="space-y-1">
            <code>currentStepIndex: number</code>
            <div class="ml-4">
              <p class="text-sm !mt-1">Get the index of the current step.</p>
            </div>
          </li>
          <li class="space-y-1">
            <code>isFirstStep: boolean</code>
            <div class="ml-4">
              <p class="text-sm !mt-1">Check if the current step is the first step.</p>
            </div>
          </li>
          <li class="space-y-1">
            <code>isLastStep: boolean</code>
            <div class="ml-4">
              <p class="text-sm !mt-1">Check if the current step is the last step.</p>
            </div>
          </li>
          <li class="space-y-1">
            <code>currentStep: TimelineStep | null</code>
            <div class="ml-4">
              <p class="text-sm !mt-1">Get the current step object.</p>
            </div>
          </li>
          <li class="space-y-1">
            <code>currentStepData: unknown | null</code>
            <div class="ml-4">
              <p class="text-sm !mt-1">Get the data of the current step.</p>
            </div>
          </li>
          <li class="space-y-1">
            <code>allStepsData: Array&lt;&#123;id?: string; title: string; data: unknown&#125;&gt;</code>
            <div class="ml-4">
              <p class="text-sm !mt-1">
                Get all steps data to be reviewed. Returns an array with step identifiers and data.
              </p>
            </div>
          </li>
        </ul>

        <h4>Methods</h4>
        <ul class="list-disc space-y-2 ml-6">
          <li class="space-y-1">
            <code>getStepData&lt;T&gt;(key: string): T | null</code>
            <div class="ml-4">
              <p class="text-sm !mt-1">
                Get the data of a specific step by its id or title. Returns <code>null</code> if the step is not found.
              </p>
            </div>
          </li>
        </ul>
      </div>
    </div>
  </section>
</cll-page-container>
